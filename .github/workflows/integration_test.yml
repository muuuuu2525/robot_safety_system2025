name: Integration Test
on: [push]

jobs:
  test_script:
    runs-on: ubuntu-24.04
    steps:
      - uses: actions/checkout@v4

      # ROS 2 Jazzy 環境をセットアップ
      - uses: ros-tooling/setup-ros@v0.7
        with:
          required-ros-distributions: jazzy

      # ディレクトリ構成を test.bash の想定 (~/ros2_ws/src/...) に合わせる
      - name: Setup Workspace and Run Test
        run: |
          mkdir -p ~/ros2_ws/src/robot_safety_system
          cp -r . ~/ros2_ws/src/robot_safety_system
          chmod +x ~/ros2_ws/src/robot_safety_system/test/test.bash
          bash ~/ros2_ws/src/robot_safety_system/test/test.bash
